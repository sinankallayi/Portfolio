<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Background Remover | AI Tools</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@100;300;400;700&display=swap"
        rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Space Grotesk"', 'sans-serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    colors: {
                        black: '#050505',
                        white: '#fafafa',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }

        /* Dot Pattern Background */
        .bg-dots {
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 24px 24px;
        }

        .dark .bg-dots {
            background-image: radial-gradient(#333 1px, transparent 1px);
        }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .dark .glass-panel {
            background: rgba(10, 10, 10, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
        }

        /* Checkerboard pattern for transparent images */
        .bg-checkerboard {
            background-image:
                linear-gradient(45deg, #ccc 25%, transparent 25%),
                linear-gradient(-45deg, #ccc 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #ccc 75%),
                linear-gradient(-45deg, transparent 75%, #ccc 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }

        .dark .bg-checkerboard {
            background-image:
                linear-gradient(45deg, #333 25%, transparent 25%),
                linear-gradient(-45deg, #333 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #333 75%),
                linear-gradient(-45deg, transparent 75%, #333 75%);
        }
    </style>
</head>

<body
    class="bg-white text-black dark:bg-black dark:text-white transition-colors duration-500 overflow-x-hidden selection:bg-black selection:text-white dark:selection:bg-white dark:selection:text-black bg-dots min-h-screen flex flex-col">

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-black/5 dark:border-white/5">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="index.html" class="flex items-center gap-2 font-mono text-sm hover:opacity-70 transition-opacity">
                <i data-lucide="arrow-left" class="w-4 h-4"></i> BACK_TO_HOME
            </a>
            <div class="text-xl font-bold font-mono tracking-tighter">
                AI_TOOLS<span class="text-blue-500">.BG_REMOVER</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="relative z-10 pt-32 pb-20 px-6 flex-grow flex flex-col items-center justify-center">

        <div class="max-w-4xl w-full">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-4">BACKGROUND REMOVER</h1>
                <p class="text-lg opacity-70">Upload an image to instantly remove its background.</p>
            </div>

            <div class="glass-panel p-8 rounded-2xl mb-12">

                <!-- Upload Area -->
                <div id="upload-area"
                    class="border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl p-12 text-center cursor-pointer hover:border-blue-500 dark:hover:border-blue-500 transition-colors group relative">
                    <input type="file" id="file-input" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                        accept="image/*">
                    <div class="flex flex-col items-center gap-4 pointer-events-none">
                        <div
                            class="p-4 bg-gray-100 dark:bg-neutral-800 rounded-full group-hover:scale-110 transition-transform duration-300">
                            <i data-lucide="upload-cloud" class="w-8 h-8 opacity-50"></i>
                        </div>
                        <div>
                            <p class="font-bold text-lg">Click or Drag & Drop to Upload</p>
                            <p class="text-sm opacity-50 font-mono mt-1">JPG, PNG, WEBP supported</p>
                        </div>
                    </div>
                </div>

                <!-- Processing State -->
                <div id="processing-state" class="hidden py-12 text-center">
                    <div class="inline-block animate-spin mb-4">
                        <i data-lucide="loader-2" class="w-8 h-8 text-blue-500"></i>
                    </div>
                    <p class="font-mono animate-pulse">PROCESSING_IMAGE...</p>
                    <p class="text-xs opacity-50 mt-2">This happens locally in your browser.</p>
                    <p class="text-[10px] font-mono opacity-40 mt-1">Multi-threaded processing enabled</p>
                </div>

                <!-- Result Area -->
                <div id="result-area" class="hidden">
                    <div class="grid md:grid-cols-2 gap-8 mb-8">
                        <!-- Original -->
                        <div>
                            <h3 class="font-mono text-xs font-bold mb-2 opacity-50">ORIGINAL</h3>
                            <div
                                class="rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 bg-gray-100 dark:bg-neutral-900 h-64 flex items-center justify-center">
                                <img id="original-image" class="max-w-full max-h-full object-contain" src=""
                                    alt="Original">
                            </div>
                        </div>

                        <!-- Result -->
                        <div>
                            <h3 class="font-mono text-xs font-bold mb-2 opacity-50">RESULT</h3>
                            <div
                                class="rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 bg-checkerboard h-64 flex items-center justify-center relative">
                                <img id="result-image" class="max-w-full max-h-full object-contain relative z-10" src=""
                                    alt="Result">
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-center gap-4">
                        <button id="reset-btn"
                            class="px-6 py-3 rounded-lg border border-current hover:bg-black hover:text-white dark:hover:bg-white dark:hover:text-black transition-all font-mono text-sm font-bold">
                            UPLOAD_NEW
                        </button>
                        <a id="download-btn" href="#" download="removed-bg.png"
                            class="px-6 py-3 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-all font-mono text-sm font-bold flex items-center gap-2">
                            <i data-lucide="download" class="w-4 h-4"></i> DOWNLOAD_PNG
                        </a>
                    </div>
                </div>

                <!-- Error Message -->
                <div id="error-message"
                    class="hidden mt-4 p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-red-500 text-sm font-mono text-center">
                </div>

            </div>

            <!-- Info Section -->
            <div class="grid md:grid-cols-2 gap-8 text-left">
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="font-bold mb-2 flex items-center gap-2">
                        <i data-lucide="cpu" class="w-4 h-4 text-blue-500"></i> How it works
                    </h3>
                    <p class="text-sm opacity-70 leading-relaxed">
                        This tool uses advanced AI models to detect and remove backgrounds from images automatically.
                        The entire process runs in your browser using WebAssembly and machine learning.
                    </p>
                </div>
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="font-bold mb-2 flex items-center gap-2">
                        <i data-lucide="shield-check" class="w-4 h-4 text-green-500"></i> Privacy
                    </h3>
                    <p class="text-sm opacity-70 leading-relaxed">
                        Your images are processed entirely on your device. No data is uploaded to any server, ensuring
                        complete privacy and security.
                    </p>
                </div>
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="font-bold mb-2 flex items-center gap-2">
                        <i data-lucide="lightbulb" class="w-4 h-4 text-yellow-500"></i> Use cases
                    </h3>
                    <p class="text-sm opacity-70 leading-relaxed">
                        Product photography, profile pictures, graphic design, presentations, social media content, and
                        more.
                    </p>
                </div>
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="font-bold mb-2 flex items-center gap-2">
                        <i data-lucide="file-output" class="w-4 h-4 text-purple-500"></i> Output format
                    </h3>
                    <p class="text-sm opacity-70 leading-relaxed">
                        Images are saved as PNG with transparent backgrounds, perfect for overlaying on other designs.
                    </p>
                </div>
                <div
                    class="md:col-span-2 glass-panel p-4 rounded-xl flex items-center justify-center gap-2 text-sm font-mono opacity-60">
                    <i data-lucide="zap" class="w-4 h-4"></i>
                    Use Multi-threaded processing enabled for faster performance
                </div>
            </div>
        </div>

    </main>

    <script type="module">
        import { removeBackground } from "https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.0.5/+esm";

        lucide.createIcons();

        const fileInput = document.getElementById('file-input');
        const uploadArea = document.getElementById('upload-area');
        const processingState = document.getElementById('processing-state');
        const resultArea = document.getElementById('result-area');
        const originalImage = document.getElementById('original-image');
        const resultImage = document.getElementById('result-image');
        const downloadBtn = document.getElementById('download-btn');
        const resetBtn = document.getElementById('reset-btn');
        const errorMessage = document.getElementById('error-message');

        // Drag and drop effects
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('border-blue-500', 'bg-blue-50', 'dark:bg-blue-900/20');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('border-blue-500', 'bg-blue-50', 'dark:bg-blue-900/20');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('border-blue-500', 'bg-blue-50', 'dark:bg-blue-900/20');
            if (e.dataTransfer.files.length) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFile(e.target.files[0]);
            }
        });

        resetBtn.addEventListener('click', () => {
            resultArea.classList.add('hidden');
            uploadArea.classList.remove('hidden');
            fileInput.value = ''; // Reset input
            errorMessage.classList.add('hidden');
        });

        async function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('Please upload an image file.');
                return;
            }

            // Show processing
            uploadArea.classList.add('hidden');
            processingState.classList.remove('hidden');
            errorMessage.classList.add('hidden');

            // Display original
            const reader = new FileReader();
            reader.onload = (e) => {
                originalImage.src = e.target.result;
            };
            reader.readAsDataURL(file);

            try {
                // Process image using imgly
                // Strategy: Explicitly map every asset type to its correct CDN location.
                // This avoids ambiguity with publicPath and ensures version consistency (1.0.5).
                const config = {
                    publicPath: 'https://unpkg.com/@imgly/background-removal@1.0.5/dist/', // Default base (ignored by interceptor mostly)
                    fetch: (url, options) => {
                        // Extract filename from the URL (ignoring whatever base path the lib added)
                        const filename = url.split('/').pop();

                        // Map assets to their correct packages
                        if (filename.endsWith('.wasm') || filename.endsWith('.js')) {
                            // Code assets -> main package
                            return fetch(`https://unpkg.com/@imgly/background-removal@1.0.5/dist/${filename}`, options);
                        } else {
                            // Model assets (onnx, json) -> data package
                            return fetch(`https://unpkg.com/@imgly/background-removal-data@1.0.5/dist/${filename}`, options);
                        }
                    },
                    debug: true,
                    progress: (key, current, total) => {
                        console.log(`Downloading ${key}: ${current} of ${total}`);
                    }
                };

                const blob = await removeBackground(file, config);

                // Create URL for result
                const url = URL.createObjectURL(blob);
                resultImage.src = url;
                downloadBtn.href = url;

                // Show result
                processingState.classList.add('hidden');
                resultArea.classList.remove('hidden');
            } catch (error) {
                console.error(error);
                errorMessage.textContent = 'Error: ' + error.message;
                errorMessage.classList.remove('hidden');
                processingState.classList.add('hidden');
                uploadArea.classList.remove('hidden');
            }
        }
    </script>
</body>

</html>